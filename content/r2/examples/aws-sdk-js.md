---
title: Configure `aws-sdk-js` for R2
summary: Example of how to configure `aws-sdk-js` to use R2.
pcx-content-type: configuration
weight: 1001
layout: example
---

{{<render file="_keys.md">}}

JavaScript or TypeScript users may continue to use the [`aws-sdk`](https://www.npmjs.com/package/aws-sdk) npm package as per normal. You must pass in the R2 configuration credentials when instantiating your `S3` service client:

```ts
import S3 from 'aws-sdk/clients/s3.js';

const s3 = new S3({
  endpoint: `https://${accountid}.r2.cloudflarestorage.com`,
  accessKeyId: `${access_key_id}`,
  secretAccessKey: `${access_key_secret}`,
});

console.log(
  await s3.listBuckets().promise()
);
//=> {
//=>   Buckets: [
//=>     { Name: 'user-uploads', CreationDate: 2022-04-13T21:23:47.102Z },
//=>     { Name: 'my-bucket-name', CreationDate: 2022-05-07T02:46:49.218Z }
//=>   ],
//=>   Owner: {
//=>     DisplayName: '...',
//=>     ID: '...'
//=>   }
//=> }

console.log(
  await s3.listObjects({ Bucket: 'my-bucket-name' }).promise()
);
//=> {
//=>   IsTruncated: false,
//=>   Name: 'my-bucket-name',
//=>   CommonPrefixes: [],
//=>   MaxKeys: 1000,
//=>   Contents: [
//=>     {
//=>       Key: 'cat.png',
//=>       LastModified: 2022-05-07T02:50:45.616Z,
//=>       ETag: '"c4da329b38467509049e615c11b0c48a"',
//=>       ChecksumAlgorithm: [],
//=>       Size: 751832,
//=>       Owner: [Object]
//=>     },
//=>     {
//=>       Key: 'todos.txt',
//=>       LastModified: 2022-05-07T21:37:17.150Z,
//=>       ETag: '"29d911f495d1ba7cb3a4d7d15e63236a"',
//=>       ChecksumAlgorithm: [],
//=>       Size: 279,
//=>       Owner: [Object]
//=>     }
//=>   ]
//=> }
```

You can also generate presigned links that can be used to share public read or write access to a bucket temporarily.

```ts
// Use the expires property to determine how long the presigned link is valid.
console.log(
  await s3.getSignedUrlPromise('getObject', { Bucket: 'my-bucket-name', Key: 'dog.png', Expires: 3600 })
)
// https://my-bucket-name.<accountid>.r2.cloudflarestorage.com/dog.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=b23bdc13c027c407213b95231dccd0d8%2F20220619%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20220619T202513Z&X-Amz-Expires=3600&X-Amz-Signature=dd6692d1ff90e95bed555eb1371099eb2c779ab3f884dadf713b38ea762e3376&X-Amz-SignedHeaders=host

// You can also create links for operations such as putObject to allow temporary write access to a specific key.
console.log(
  await s3.getSignedUrlPromise('putObject', { Bucket: 'my-bucket-name', Key: 'dog.png', Expires: 3600 })
)
```

You can use the link generated by the `putObject` example to upload to the specified bucket and key, until the presigned link expires.

```sh
$ curl -X PUT https://my-bucket-name.<accountid>.r2.cloudflarestorage.com/dog.png\?X-Amz-Algorithm\=AWS4-HMAC-SHA256\&X-Amz-Credential\=b23bdc13c027c407213b95231dccd0d8%2F20220619%2Fus-east-1%2Fs3%2Faws4_request\&X-Amz-Date\=20220619T202907Z\&X-Amz-Expires\=3600\&X-Amz-Signature\=1fa869c77f1f5740a933d4308abc255602c6b16f298960d430cfdd179d52f4fc\&X-Amz-SignedHeaders\=host -F "data=@dog.png"
```
